<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-134049127-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>和我一起入坑-React-Native入门-ToDoList | Yiluyanxia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-site-verification" content="Z2eTUO78NDUbUNrYk5dUHLf6we_TOAle3WKpEFw5Dk4" />
  <meta name="baidu-site-verification" content="1CQQGgl03Q" />
  
  <meta name="keywords" content="前端" />
  
  <meta name="description" content="前置工作（〇）了解官方文档是必须的react-native官方文档react-native中文文档   （一）安装必需的软件以下步骤官网早有详细步骤，在此不必赘述。1.ChocolateyChocolatey的官网使用管理员打开cmd,输入 1@&quot;%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoPr">
<meta property="og:type" content="article">
<meta property="og:title" content="和我一起入坑-React-Native入门-ToDoList">
<meta property="og:url" content="https://yiluyanxia.github.io/eacab164.html">
<meta property="og:site_name" content="Yiluyanxia">
<meta property="og:description" content="前置工作（〇）了解官方文档是必须的react-native官方文档react-native中文文档   （一）安装必需的软件以下步骤官网早有详细步骤，在此不必赘述。1.ChocolateyChocolatey的官网使用管理员打开cmd,输入 1@&quot;%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoPr">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yiluyanxia.github.io/eacab164/%E5%AE%89%E8%A3%85python2.png">
<meta property="og:image" content="https://yiluyanxia.github.io/eacab164/Android-studio%E6%8A%A5%E9%94%99.png">
<meta property="og:image" content="https://yiluyanxia.github.io/eacab164/todolist_prv.gif">
<meta property="og:image" content="https://yiluyanxia.github.io/eacab164/rn_todolist_%E6%B5%81%E7%A8%8B%E5%9B%BE.png">
<meta property="article:published_time" content="2018-08-25T05:45:21.000Z">
<meta property="article:modified_time" content="2022-12-01T10:49:35.076Z">
<meta property="article:author" content="yiluyanxia">
<meta property="article:tag" content="React Native">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yiluyanxia.github.io/eacab164/%E5%AE%89%E8%A3%85python2.png">
  
    <link rel="alternate" href="/atom.xml" title="Yiluyanxia" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
        <a class="nav-item" href="https://github.com/yiluyanxia" title
        
          target='_blank'
        
        >姬友</a>
      
        <a class="nav-item" href="/mood" title
        
          target='_blank'
        
        >心情</a>
      
        <a class="nav-item" href="/pda" title
        
          target='_blank'
        
        >手账</a>
      
        <a class="nav-item" href="/topup" title
        
        >Top Up</a>
      
        <a class="nav-item" href="/about" title
        
        >本王</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-和我一起入坑-React-Native入门-ToDoList" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      和我一起入坑-React-Native入门-ToDoList
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/eacab164.html" class="article-date">
  <time datetime="2018-08-25T05:45:21.000Z" itemprop="datePublished">2018-08-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%85%A5%E5%9D%91%E6%95%99%E7%A8%8B/">入坑教程</a>
  </div>

    
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native/" rel="tag">React Native</a></li></ul>

  </div>
  <!--
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  -->

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h1 id="前置工作"><a href="#前置工作" class="headerlink" title="前置工作"></a>前置工作</h1><h2 id="（〇）了解官方文档是必须的"><a href="#（〇）了解官方文档是必须的" class="headerlink" title="（〇）了解官方文档是必须的"></a>（〇）了解官方文档是必须的</h2><p><a target="_blank" rel="noopener" href="http://facebook.github.io/react-native/docs/getting-started.html">react-native官方文档</a><br><a target="_blank" rel="noopener" href="https://reactnative.cn/docs/0.51/getting-started.html#python-2">react-native中文文档</a>  </p>
<h2 id="（一）安装必需的软件"><a href="#（一）安装必需的软件" class="headerlink" title="（一）安装必需的软件"></a>（一）安装必需的软件</h2><p>以下步骤官网早有详细步骤，在此不必赘述。<br>1.Chocolatey<br><a target="_blank" rel="noopener" href="https://chocolatey.org/install">Chocolatey</a>的官网<br>使用管理员打开cmd,输入</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@&quot;%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe&quot; -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command &quot;iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://chocolatey.org/install.ps1&#x27;))&quot; &amp;&amp; SET &quot;PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&quot;</span><br></pre></td></tr></table></figure></div>

<p>2.安装Python 2<br>在cmd中输入</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install python2</span><br></pre></td></tr></table></figure></div>
<span id="more"></span>
<img src="/eacab164/%E5%AE%89%E8%A3%85python2.png" class="" title="安装python2">
<p>输入y,不要直接回车。</p>
<p>3.安装node</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install  nodejs.install </span><br></pre></td></tr></table></figure></div>
<p>在此之前我已经用nvm安装过node了。</p>
<p>4.安装jdk8</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choco install jdk8</span><br></pre></td></tr></table></figure></div>
<p>在此之前我已经去官网下载jdk了。<br>注意：jdk版本需为8。</p>
<p>5.安装Yarn、React Native的命令行工具</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g yarn react-native-cli</span><br></pre></td></tr></table></figure></div>
<p>设置镜像源</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn config set registry https://registry.npm.taobao.org --global</span><br><span class="line">yarn config set disturl https://npm.taobao.org/dist --global</span><br></pre></td></tr></table></figure></div>

<p>6.安装Android Studio<br>按照官网的配置进行配置即可。（<em>虽然我觉得很麻烦＞﹏＜</em>）</p>
<p>7.初始化项目</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">react-native init AwesomeProject</span><br><span class="line">cd AwesomeProject</span><br><span class="line">react-native run-android</span><br></pre></td></tr></table></figure></div>
<p>然后bug就来了，出现红色的提示<br>我的理解就是模拟器没有关联并启动所导致的。（可能是错误的）</p>
<h2 id="（二）在模拟器中运行"><a href="#（二）在模拟器中运行" class="headerlink" title="（二）在模拟器中运行"></a>（二）在模拟器中运行</h2><p>然后打算使用Android Studio直接运行项目。<br>在初步安装完成后按照官网进行配置以完成全部的安装。<br>打开已存在的项目，注意选择的是项目下的Android文件夹<br>稍等几分钟运行按钮由灰色变成绿色，但是模拟器并没有跑起来。</p>
<img src="/eacab164/Android-studio%E6%8A%A5%E9%94%99.png" class="" title="Android-studio报错">

<p>原因是 “Vt-x is disabled in BIOS”</p>
<p>遇到问题，首先是想到伟大的网友们。</p>
<p><a target="_blank" rel="noopener" href="http://www.bluestacks.cn/faq/41_0_1_7.html">华硕主板BIOS UEFI BIOS开启VT步骤</a><br>期间还尝试使用其他模拟器来跑项目，例如”夜神模拟器”，但是怕领导以为我在打游戏，就决定还是用Android Studio，看起来专业一点。</p>
<h1 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h1><h2 id="（三）TodoList的结构"><a href="#（三）TodoList的结构" class="headerlink" title="（三）TodoList的结构"></a>（三）TodoList的结构</h2><ol start="0">
<li>完成效果预览  </li>
</ol>
<p><em>晃眼的骚粉 哇咔咔</em>  </p>
<img src="/eacab164/todolist_prv.gif" class="" title="todolist_prv"> 

<p>1.为了达到真正的入坑，而不是在坑前停留，我会故意把TodoList写得复杂一丢丢，比如添加导航功能，实现数据存储、组件通信的功能等。  </p>
<p>TodoList 流程图： </p>
<img src="/eacab164/rn_todolist_%E6%B5%81%E7%A8%8B%E5%9B%BE.png" class="" title="rn_todolist_流程图">
<p><em>(图片使用processOn制作，好丑)</em> </p>
<p>2.安装所需的插件。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-native-vector-icons react-navigation --save</span><br></pre></td></tr></table></figure></div>
<p>安卓没有navigation，官方推荐 react-navigation，<a target="_blank" rel="noopener" href="https://oblador.github.io/react-native-vector-icons/">react-native-vector-icons</a> 是一个超级好用的图标库，只要复制了图标的名字就可以为所欲为。</p>
<p>3.根据自己的习惯创建文件夹，我是如下创建的：</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">├── android                                    </span><br><span class="line">├── ios         </span><br><span class="line">├── src                                         </span><br><span class="line">│   ├── todolist                             </span><br><span class="line">│   │   ├── utils                              </span><br><span class="line">│   │   │   └── utils.js                                          </span><br><span class="line">│   │   ├── add.js                              </span><br><span class="line">│   │   ├── all.js</span><br><span class="line">│   │   ├── completed.js</span><br><span class="line">│   │   ├── incomplete.js   </span><br><span class="line">│   │   └── todoItem.js</span><br><span class="line">│   ├── index.js </span><br><span class="line">│   ├── router.js</span><br><span class="line">├── index.js     </span><br></pre></td></tr></table></figure></div>
<p>这些是用到的文件，其他保持生成时默认的就好了。</p>
<h2 id="（四）实现TodoList的功能"><a href="#（四）实现TodoList的功能" class="headerlink" title="（四）实现TodoList的功能"></a>（四）实现TodoList的功能</h2><h3 id="编写router和基本文件"><a href="#编写router和基本文件" class="headerlink" title="编写router和基本文件"></a>编写router和基本文件</h3><p>导入所需的文件，并编写项目的整体结构，从代码可以看出，底部的导航可以切换所有的事项，未完成的事项，已完成的事项三个页面。样式什么的就自由发挥吧。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; </span><br><span class="line">  createStackNavigator,</span><br><span class="line">  createBottomTabNavigator</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-navigation&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Ionicons</span> <span class="keyword">from</span> <span class="string">&#x27;react-native-vector-icons/Ionicons&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AllList</span> <span class="keyword">from</span> <span class="string">&#x27;./todolist/all&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AddTodo</span> <span class="keyword">from</span> <span class="string">&#x27;./todolist/add&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Completed</span> <span class="keyword">from</span> <span class="string">&#x27;./todolist/completed&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Incomplete</span> <span class="keyword">from</span> <span class="string">&#x27;./todolist/incomplete&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">TodolistTabs</span> = <span class="title function_">createBottomTabNavigator</span>(&#123;</span><br><span class="line">  <span class="title class_">All</span>: &#123;<span class="attr">screen</span>: <span class="title class_">AllList</span> &#125;,</span><br><span class="line">  <span class="title class_">Incomplete</span>: &#123;<span class="attr">screen</span>: <span class="title class_">Incomplete</span>&#125;,</span><br><span class="line">  <span class="title class_">Completed</span>: &#123;<span class="attr">screen</span>: <span class="title class_">Completed</span>&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">navigationOptions</span>:<span class="function">(<span class="params">&#123; navigation &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">tabBarIcon</span>: <span class="function">(<span class="params">&#123; focused, tintColor&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; routeName &#125; = navigation.<span class="property">state</span>;</span><br><span class="line">      <span class="keyword">let</span> iconName;</span><br><span class="line">      <span class="keyword">if</span> (routeName === <span class="string">&#x27;All&#x27;</span>)&#123;</span><br><span class="line">        iconName = <span class="string">`ios-list-box<span class="subst">$&#123;focused ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;-outline&#x27;</span>&#125;</span>`</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(routeName === <span class="string">&#x27;Completed&#x27;</span>)&#123;</span><br><span class="line">        iconName = <span class="string">`ios-flag<span class="subst">$&#123;focused ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;-outline&#x27;</span>&#125;</span>`</span></span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(routeName === <span class="string">&#x27;Incomplete&#x27;</span>)&#123;</span><br><span class="line">        iconName = <span class="string">`ios-create<span class="subst">$&#123;focused ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;-outline&#x27;</span>&#125;</span>`</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Ionicons</span> <span class="attr">name</span>=<span class="string">&#123;iconName&#125;</span> <span class="attr">size</span>=<span class="string">&#123;25&#125;</span> <span class="attr">color</span>=<span class="string">&#123;tintColor&#125;</span> /&gt;</span></span></span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">tabBarOptions</span>: &#123;</span><br><span class="line">    <span class="attr">activeTintColor</span>: <span class="string">&#x27;#FF4081&#x27;</span>,</span><br><span class="line">    <span class="attr">inactiveTintColor</span>: <span class="string">&#x27;#455A64&#x27;</span>,</span><br><span class="line">    <span class="attr">labelStyle</span>:&#123;</span><br><span class="line">      <span class="attr">fontSize</span>: <span class="number">13</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">style</span>:&#123;</span><br><span class="line">      <span class="attr">backgroundColor</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">TodolistStack</span> = <span class="title function_">createStackNavigator</span>(&#123;</span><br><span class="line">  <span class="title class_">TodoTab</span>: &#123;</span><br><span class="line">    <span class="attr">screen</span>: <span class="title class_">TodolistTabs</span>,</span><br><span class="line">    <span class="attr">navigationOptions</span>:&#123;</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&#x27;Todo list&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title class_">Add</span>: &#123;</span><br><span class="line">    <span class="attr">screen</span>: <span class="title class_">AddTodo</span>,</span><br><span class="line">    <span class="attr">navigationOptions</span>:&#123;</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&#x27;Add&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">navigationOptions</span>: <span class="function">(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">    navigation</span></span></span><br><span class="line"><span class="params"><span class="function">  &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">      <span class="attr">headerStyle</span>:&#123;</span><br><span class="line">        <span class="attr">backgroundColor</span>: <span class="string">&#x27;#FF4081&#x27;</span>,</span><br><span class="line">        <span class="attr">borderBottomColor</span>: <span class="string">&#x27;transparent&#x27;</span>,</span><br><span class="line">        <span class="attr">borderWidth</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">elevation</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">shadowOpacity</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">headerTintColor</span>: <span class="string">&#x27;#fff&#x27;</span>,</span><br><span class="line">      <span class="attr">headerTitleStyle</span>: &#123;</span><br><span class="line">        <span class="attr">flex</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">textAlign</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;<span class="title class_">Component</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TodolistStack</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">TodolistStack</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AwesomeProject/index,js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppRegistry</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./src/index&#x27;</span></span><br><span class="line"><span class="title class_">AppRegistry</span>.<span class="title function_">registerComponent</span>(<span class="string">&#x27;AwesomeProject&#x27;</span>, <span class="function">() =&gt;</span> <span class="title class_">App</span>);</span><br></pre></td></tr></table></figure></div>
<h3 id="编写ALL页面"><a href="#编写ALL页面" class="headerlink" title="编写ALL页面"></a>编写ALL页面</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;<span class="title class_">Component</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line"> <span class="title class_">StyleSheet</span>,</span><br><span class="line"> <span class="title class_">View</span>,</span><br><span class="line"> <span class="title class_">FlatList</span>,</span><br><span class="line"> <span class="title class_">TouchableOpacity</span>,</span><br><span class="line"> <span class="title class_">AsyncStorage</span>,</span><br><span class="line"> <span class="title class_">DeviceEventEmitter</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TodoItem</span> <span class="keyword">from</span> <span class="string">&#x27;./todoItem&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Ionicons</span> <span class="keyword">from</span> <span class="string">&#x27;react-native-vector-icons/Ionicons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Utils</span> <span class="keyword">from</span> <span class="string">&#x27;./utils/utils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">AllScreen</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>)&#123;  </span><br><span class="line">    <span class="variable language_">super</span>(props);   </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;  </span><br><span class="line">      <span class="attr">todolistData</span>: [],</span><br><span class="line">    &#125;  </span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">listener</span> = <span class="title class_">DeviceEventEmitter</span>.<span class="title function_">addListener</span>(<span class="string">&#x27;todolist_add&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">componentWillReceiveProps</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">listener</span>)&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">listener</span>.<span class="title function_">remove</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">_getTodolistData</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> todoListArr = (result != <span class="literal">null</span>) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(result) :[];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">todolistData</span>: todoListArr</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_checkTodo</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> todolistData = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> , len = todolistData.<span class="property">length</span>; i&lt;len; i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(item.<span class="property">id</span> === todolistData[i].<span class="property">id</span>)&#123;</span><br><span class="line">        todolistData[i].<span class="property">isComplete</span> = !todolistData[i].<span class="property">isComplete</span> </span><br><span class="line">       </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(todolistData), <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _navigationAdd = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">navigation</span>.<span class="title function_">navigate</span>(<span class="string">&#x27;Add&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> todoList = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.wrapper&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FlatList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">data</span>=<span class="string">&#123;todoList&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">keyExtractor</span> = <span class="string">&#123;(item,</span> <span class="attr">index</span>) =&gt;</span> item.id.toString()&#125;</span></span><br><span class="line"><span class="language-xml">          renderItem=&#123;(&#123;item,index&#125;) =&gt; <span class="tag">&lt;<span class="name">TodoItem</span> <span class="attr">dataItem</span>=<span class="string">&#123;item&#125;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span> <span class="attr">checkTodo</span>=<span class="string">&#123;(item)</span>=&gt;</span>this._checkTodo(item)&#125; /&gt; &#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">style</span>=<span class="string">&#123;styles.addBtn&#125;</span> <span class="attr">onPress</span>=<span class="string">&#123;this._navigationAdd&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Ionicons</span> <span class="attr">name</span>=<span class="string">&quot;md-add&quot;</span> <span class="attr">size</span>=<span class="string">&#123;38&#125;</span> <span class="attr">color</span>=<span class="string">&quot;#fff&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = <span class="title class_">StyleSheet</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">wrapper</span>: &#123;</span><br><span class="line">    <span class="attr">flex</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">addBtn</span>:&#123;</span><br><span class="line">    <span class="attr">position</span>: <span class="string">&quot;relative&quot;</span>,</span><br><span class="line">    <span class="attr">left</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">bottom</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">borderRadius</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&quot;#FF4081&quot;</span>,</span><br><span class="line">    <span class="attr">alignItems</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">    <span class="attr">alignContent</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">    <span class="attr">justifyContent</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h3 id="TodoItem组件"><a href="#TodoItem组件" class="headerlink" title="TodoItem组件"></a>TodoItem组件</h3><p>因为All、Incomplete、 Complete页面都需要事项的页面，所以将他分离出来做一个单独的组件使用。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;<span class="title class_">Component</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">Alert</span>,</span><br><span class="line">  <span class="title class_">StyleSheet</span>,</span><br><span class="line">  <span class="title class_">View</span>,</span><br><span class="line">  <span class="title class_">Text</span>,</span><br><span class="line">  <span class="title class_">TouchableHighlight</span>,</span><br><span class="line">  <span class="title class_">TouchableOpacity</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Ionicons</span> <span class="keyword">from</span> <span class="string">&#x27;react-native-vector-icons/Ionicons&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TodoItem</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">switchValue</span>: <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">dataItem</span>.<span class="property">isComplete</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">componentWillReceiveProps</span>(<span class="params">nextProps</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setCompleteState</span>(nextProps.<span class="property">dataItem</span>.<span class="property">isComplete</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setCompleteState</span>(<span class="params">isComplete</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">switchValue</span>: isComplete</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">_onSwitch</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setCompleteState</span>(!<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">switchValue</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">checkTodo</span>(<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">dataItem</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render ()&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.todoitem&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TouchableHighlight</span>  <span class="attr">underlayColor</span>=<span class="string">&quot;#90CAF9&quot;</span> <span class="attr">onPress</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">this._onSwitch.bind</span>(<span class="attr">this</span>)</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">         &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Ionicons</span> <span class="attr">name</span>=<span class="string">&#123;this.state.switchValue?</span> &quot;<span class="attr">md-checkbox</span>&quot;<span class="attr">:</span>&quot;<span class="attr">md-square-outline</span>&quot;&#125; <span class="attr">size</span>=<span class="string">&#123;34&#125;</span> <span class="attr">style</span>=<span class="string">&#123;this.state.switchValue?</span> <span class="attr">styles.colorOff:styles.colorOn</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TouchableHighlight</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TouchableOpacity</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;this.state.switchValue?</span> <span class="attr">styles.itemtxtOff:styles.itemtxt</span>&#125;&gt;</span>&#123;this.props.dataItem.content&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">TodoItem</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = <span class="title class_">StyleSheet</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">todoitem</span>: &#123;</span><br><span class="line">    <span class="attr">flexDirection</span>: <span class="string">&quot;row&quot;</span>,</span><br><span class="line">    <span class="attr">justifyContent</span>: <span class="string">&quot;space-between&quot;</span>,</span><br><span class="line">    <span class="attr">alignItems</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="attr">alignContent</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">colorOn</span>:&#123;</span><br><span class="line">    <span class="attr">color</span>:<span class="string">&quot;#F50057&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">colorOff</span>:&#123;</span><br><span class="line">    <span class="attr">color</span>:<span class="string">&quot;#e0e0e0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">itemtxt</span>:&#123;</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#000&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">itemtxtOff</span>:&#123;</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="number">30</span>,   </span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#666&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<h3 id="Incomplete、Complete页面"><a href="#Incomplete、Complete页面" class="headerlink" title="Incomplete、Complete页面"></a>Incomplete、Complete页面</h3><p>Incomplete、Complete页面和All页面基本一样，只是在渲染页面前将数据过滤了。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// incomplete.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;<span class="title class_">Component</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">StyleSheet</span>,</span><br><span class="line">  <span class="title class_">View</span>,</span><br><span class="line">  <span class="title class_">FlatList</span>,</span><br><span class="line">  <span class="title class_">AsyncStorage</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TodoItem</span> <span class="keyword">from</span> <span class="string">&#x27;./todoItem&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Utils</span> <span class="keyword">from</span> <span class="string">&#x27;./utils/utils&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">IncompleteScreen</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">todolistData</span>:[],</span><br><span class="line">      <span class="attr">incompleteData</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillReceiveProps</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">_getTodolistData</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> todoListArr = (result != <span class="literal">null</span>) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(result) :[];</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">todolistData</span>: todoListArr</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">let</span> todoListFilter= <span class="title class_">Utils</span>.<span class="title function_">filterArr</span>(todoListArr);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">incompleteData</span>: todoListFilter[<span class="literal">false</span>]</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_checkTodo</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> todolistData = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> , len = todolistData.<span class="property">length</span>; i&lt;len; i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(item.<span class="property">id</span> === todolistData[i].<span class="property">id</span>)&#123;</span><br><span class="line">        todolistData[i].<span class="property">isComplete</span> = !todolistData[i].<span class="property">isComplete</span> </span><br><span class="line">        <span class="title class_">AsyncStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(todolistData), <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> todoList = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">incompleteData</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.wrapper&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FlatList</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">data</span>=<span class="string">&#123;todoList&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">keyExtractor</span> = <span class="string">&#123;(item,</span> <span class="attr">index</span>) =&gt;</span> item.id&#125;</span></span><br><span class="line"><span class="language-xml">          renderItem=&#123;(&#123;item, index&#125;) =&gt; </span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">TodoItem</span> <span class="attr">dataItem</span>=<span class="string">&#123;item&#125;</span> <span class="attr">checkTodo</span>=<span class="string">&#123;(item)</span>=&gt;</span>this._checkTodo(item)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = <span class="title class_">StyleSheet</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">wrapper</span>: &#123;</span><br><span class="line">    <span class="attr">flex</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">10</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Utils</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">filterArr</span>(<span class="params">dataArr</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> list = dataArr, data = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; list.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!data[list[i].<span class="property">isComplete</span>]) &#123;</span><br><span class="line">        <span class="keyword">var</span> arr = [];</span><br><span class="line">        arr.<span class="title function_">push</span>(list[i]);</span><br><span class="line">        data[list[i].<span class="property">isComplete</span>] = arr;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        data[list[i].<span class="property">isComplete</span>].<span class="title function_">push</span>(list[i])</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
<p>Complete页面和Incomplete完全一样，除了将todoListFilter[false]改为todoListFilter[true]。</p>
<h3 id="Add页面"><a href="#Add页面" class="headerlink" title="Add页面"></a>Add页面</h3><p>Add页面中的保存按钮是写在navigationOptions里，如果直接使用this._saveTodo是拿不到这个方法的，需要在navigation中的内置函数setParams中声明，方可使用。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;<span class="title class_">Component</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line"> <span class="title class_">StyleSheet</span>,</span><br><span class="line"> <span class="title class_">View</span>,</span><br><span class="line"> <span class="title class_">TextInput</span>,</span><br><span class="line"> <span class="title class_">TouchableOpacity</span>,</span><br><span class="line"> <span class="title class_">AsyncStorage</span>,</span><br><span class="line"> <span class="title class_">DeviceEventEmitter</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Ionicons</span> <span class="keyword">from</span> <span class="string">&#x27;react-native-vector-icons/Ionicons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Utils</span> <span class="keyword">from</span> <span class="string">&#x27;./utils/utils&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Add</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; </span><br><span class="line">      <span class="attr">todo</span>: </span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="attr">content</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="attr">isComplete</span>: <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">todoArr</span>:[]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> navigationOptions = <span class="function">(<span class="params">&#123; navigation &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> params = navigation.<span class="property">state</span>.<span class="property">params</span> || &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">headerRight</span>: (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">TouchableOpacity</span> <span class="attr">style</span>=<span class="string">&#123;&#123;width:</span> <span class="attr">56</span>, <span class="attr">height:</span> <span class="attr">36</span>, <span class="attr">paddingRight:20</span>&#125;&#125; <span class="attr">onPress</span>=<span class="string">&#123;params.saveTodo&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Ionicons</span> <span class="attr">name</span>=<span class="string">&quot;md-checkmark&quot;</span> <span class="attr">size</span>=<span class="string">&#123;36&#125;</span> <span class="attr">color</span>=<span class="string">&quot;#fff&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">TouchableOpacity</span>&gt;</span></span></span><br><span class="line">      ),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">navigation</span>.<span class="title function_">setParams</span>(&#123; <span class="attr">saveTodo</span>: <span class="variable language_">this</span>.<span class="property">_saveTodo</span> &#125;)</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="function">(<span class="params">err, result</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> todoArr = (result != <span class="literal">null</span>) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(result) :[]</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">todoArr</span>: todoArr</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  _saveTodo = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> todoVal = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todo</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">todoArr</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todoArr</span>.<span class="title function_">push</span>(todoVal)&#125;)</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todoArr</span>), <span class="function">()=&gt;</span>&#123;</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="title class_">DeviceEventEmitter</span>.<span class="title function_">emit</span>(<span class="string">&#x27;todolist_add&#x27;</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">navigation</span>.<span class="title function_">goBack</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">_changeTodo</span>(<span class="params">text</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> _id = <span class="title class_">Utils</span>.<span class="title function_">uniqueId</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">todo</span>:&#123;</span><br><span class="line">        <span class="attr">id</span>:_id,</span><br><span class="line">        <span class="attr">content</span>:text,</span><br><span class="line">        <span class="attr">isComplete</span>:<span class="literal">false</span></span><br><span class="line">      &#125; </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.wrapper&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TextInput</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;styles.textInput&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">underlineColorAndroid</span>=<span class="string">&quot;transparent&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChangeText</span>=<span class="string">&#123;(text)</span>=&gt;</span> &#123;this._changeTodo(text)&#125; &#125;</span></span><br><span class="line"><span class="language-xml">          value=&#123;this.state.todo.content&#125;</span></span><br><span class="line"><span class="language-xml">          multiline = &#123;true&#125;</span></span><br><span class="line"><span class="language-xml">          numberOfLines = &#123;4&#125;</span></span><br><span class="line"><span class="language-xml">          textAlignVertical=&quot;top&quot;</span></span><br><span class="line"><span class="language-xml">          placeholder=&quot;add a todo&quot;</span></span><br><span class="line"><span class="language-xml">          autoFocus=&#123;true&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Add</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = <span class="title class_">StyleSheet</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">wrapper</span>: &#123;</span><br><span class="line">    <span class="attr">flex</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">textInput</span>: &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#333&quot;</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="number">18</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p>在utils.js中添加生成唯一ID的静态函数。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="comment">// 这个方法来自网络</span></span><br><span class="line"><span class="keyword">static</span> <span class="title function_">uniqueId</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> a=<span class="title class_">Math</span>.<span class="property">random</span>,b=<span class="built_in">parseInt</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Number</span>(<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">toString</span>()+<span class="title function_">b</span>(<span class="number">10</span>*<span class="title function_">a</span>())+<span class="title function_">b</span>(<span class="number">10</span>*<span class="title function_">a</span>())+<span class="title function_">b</span>(<span class="number">10</span>*<span class="title function_">a</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>到此，添加一个事项，再切换其是否完成的状态都可以实现了。但是我们会发现代码有很多重复的地方，我们尝试将它们都分离出来。</p>
<h3 id="页面复用代码的提取"><a href="#页面复用代码的提取" class="headerlink" title="页面复用代码的提取"></a>页面复用代码的提取</h3><p>在三个主页面中都出现了这个函数，我们将其分离出来，写到utils.js中</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="keyword">static</span> <span class="title function_">_checkTodo</span>(<span class="params">item, todolistData</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> , len = todolistData.<span class="property">length</span>; i&lt;len; i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(item.<span class="property">id</span> === todolistData[i].<span class="property">id</span>)&#123;</span><br><span class="line">        todolistData[i].<span class="property">isComplete</span> = !todolistData[i].<span class="property">isComplete</span> </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">AsyncStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(todolistData), <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
<p>那么在页面中，调用函数的方式如下，将this.state.todolistData作为参数传递过去。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">TodoItem</span> dataItem=&#123;item&#125; key=&#123;item.<span class="property">id</span>&#125; checkTodo=&#123;<span class="function">(<span class="params">item</span>)=&gt;</span><span class="title class_">Utils</span>.<span class="title function_">_checkTodo</span>(item,<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span>)&#125; /&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="删除功能的实现"><a href="#删除功能的实现" class="headerlink" title="删除功能的实现"></a>删除功能的实现</h3><p>添加了太多事项，不得有删除功能吗？<br>这个方法和切换完成状态是类似的。<br>onLongPress是指长按，长按之后弹出模态框点击ok则执行删除函数。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// todoitem.js</span></span><br><span class="line">&lt;<span class="title class_">TouchableOpacity</span> onLongPress=&#123;<span class="function">()=&gt;</span>&#123; <span class="variable language_">this</span>.<span class="title function_">_showModel</span>(<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">dataItem</span>)&#125;&#125; &gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;this.state.switchValue?</span> <span class="attr">styles.itemtxtOff:styles.itemtxt</span>&#125;&gt;</span>&#123;this.props.dataItem.content&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">TouchableOpacity</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// todoitem.js</span></span><br><span class="line"><span class="title function_">_showModel</span>(<span class="params">todo</span>)&#123;</span><br><span class="line">  <span class="title class_">Alert</span>.<span class="title function_">alert</span>(</span><br><span class="line">    <span class="string">&#x27;Delete it ?&#x27;</span>,</span><br><span class="line">    todo.<span class="property">content</span>,</span><br><span class="line">    [</span><br><span class="line">      &#123;<span class="attr">text</span>: <span class="string">&#x27;Cancel&#x27;</span>, <span class="attr">onPress</span>: <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Cancel Pressed&#x27;</span>), <span class="attr">style</span>: <span class="string">&#x27;cancel&#x27;</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">text</span>: <span class="string">&#x27;OK&#x27;</span>, <span class="attr">onPress</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">deleteTodo</span>(todo)&#125;,</span><br><span class="line">    ],</span><br><span class="line">    &#123; <span class="attr">cancelable</span>: <span class="literal">false</span> &#125;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils.js</span></span><br><span class="line"><span class="keyword">static</span> <span class="title function_">_deleteTodo</span>(<span class="params">item, todolistData</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = todolistData.<span class="property">length</span>-<span class="number">1</span>; i&gt;=<span class="number">0</span>; i-- )&#123;</span><br><span class="line">      <span class="keyword">if</span>(item.<span class="property">id</span> === todolistData[i].<span class="property">id</span>)&#123;</span><br><span class="line">        todolistData.<span class="title function_">splice</span>(i, <span class="number">1</span>)</span><br><span class="line">        <span class="title class_">AsyncStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;todolistData&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(todolistData), <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>
<p>删除事项之后需要重新获取数据，不然页面上还是会显示已经被残忍删掉的数据。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">TodoItem</span> dataItem=&#123;item&#125; key=&#123;item.<span class="property">id</span>&#125; checkTodo=&#123;<span class="function">(<span class="params">item</span>)=&gt;</span><span class="title class_">Utils</span>.<span class="title function_">_checkTodo</span>(item,<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span>)&#125; </span><br><span class="line">  deleteTodo=&#123;<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;<span class="title class_">Utils</span>.<span class="title function_">_deleteTodo</span>(item, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">todolistData</span>); <span class="variable language_">this</span>.<span class="title function_">_getTodolistData</span>()&#125;&#125; /&gt;</span><br></pre></td></tr></table></figure></div>
<p>收工！！！</p>
<h3 id="说在后面的话"><a href="#说在后面的话" class="headerlink" title="说在后面的话"></a>说在后面的话</h3><p>还有修改的功能，心情好再写。<br>完整的项目在这里<a target="_blank" rel="noopener" href="https://github.com/yiluyanxia/AwesomeProject">GitHub Todolist</a>。<br><em>这不是一篇教程，而是一份纪念品。</em><br><em>共勉</em></p>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/e5e80816.html" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            和我一起入坑-Vue入门-ToDoList
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/59519.html" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">一些面试题</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: 'yiluyanxia',
  repo: 'yiluyanxia.github.io',
  oauth: {
    client_id: 'b8e8c50258809e47e61a',
    client_secret: '15a8996b14bedbbb4c2e1a540ac064d629f0c6ee',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        一路烟霞
      
    </h3>
    <p class="avatar-slogan">
      特别耐撕的小前端，不想局限于前端的攻城狮。
    </p>
  </div>
</div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Top-Up/">Top Up</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%A5%E5%9D%91%E6%95%99%E7%A8%8B/">入坑教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%81%E4%BA%BA/">私人</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%B7%B3%E5%9D%91%E8%AE%B0%E5%BD%95/">跳坑记录</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BF%9B%E6%AD%A5%E7%AC%94%E8%AE%B0/">进步笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%98%B2%E4%B8%A2%E5%A4%B1/">防丢失</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/" rel="tag">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-Native/" rel="tag">React Native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/" rel="tag">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angular/" rel="tag">angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/" rel="tag">node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/three-js/" rel="tag">three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag">云服务器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E6%83%85%E7%BB%AA/" rel="tag">小情绪</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%89%B2%E5%BD%A9/" rel="tag">色彩</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-box">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/35019.html">整个宇宙将为你闪烁 除了三体人前端也可以 哈哈</a>
          </li>
        
          <li>
            <a href="/24c57dd0.html">JSON Web Token 简介</a>
          </li>
        
          <li>
            <a href="/32c28743.html">函数进阶（箭头函数、默认参数）</a>
          </li>
        
          <li>
            <a href="/a1d95bcb.html">对象与数组的解构、rest 操作符</a>
          </li>
        
          <li>
            <a href="/e181814a.html">块级作用域、模板字符串</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2023 yiluyanxia &nbsp;&nbsp;
    驱动于 <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank">antiquity</a>
    <br>
    上帝本不公平，但凡人保持偏执的权利
    <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之  阁下是第56<span id="busuanzi_value_site_pv"></span>个访客</span>-->
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a target="_blank" rel="noopener" href="https://github.com/yiluyanxia" class="mobile-nav-link">姬友</a>
  
    <a href="/mood" class="mobile-nav-link">心情</a>
  
    <a href="/pda" class="mobile-nav-link">手账</a>
  
    <a href="/topup" class="mobile-nav-link">Top Up</a>
  
    <a href="/about" class="mobile-nav-link">本王</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>